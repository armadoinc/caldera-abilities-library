- id: 1258b063-27d6-489b-a677-4807faacf868
  name: Check Security Services
  description: Check for security services. Security service list is based on the
    SUNBURST malware observed in a Solarwinds related compromise (https://research.checkpoint.com/2020/sunburst-teardrop-and-the-netsec-new-normal/).
  tactic: defense-evasion
  technique:
    attack_id: T1497.001
    name: 'Virtualization/Sandbox Evasion: System Checks'
  platforms:
    windows:
      psh,pwsh:
        command: "$securityServices = @(\n    \"msmpeng\",\n    \"windefend\",\n \
          \   \"mssense\",\n    \"sense\",\n    \"microsoft.tri.sensor\",\n    \"\
          microsoft.tri.sensor.updater\",\n    \"cavp\",\n    \"cb\",\n    \"carbonblack\"\
          ,\n    \"carbonblackk\",\n    \"cbcomms\",\n    \"cbstream\",\n    \"csfalconservice\"\
          ,\n    \"csfalconcontainer\",\n    \"csagent\",\n    \"csdevicecontrol\"\
          ,\n    \"csfalconservice\",\n    \"xagt\",\n    \"xagtnotif\",\n    \"fe_avk\"\
          ,\n    \"fekern\",\n    \"feelam\",\n    \"fewscservice\",\n    \"ekrn\"\
          ,\n    \"eguiproxy\",\n    \"egui\",\n    \"eamonm\",\n    \"eelam\",\n\
          \    \"ehdrv\",\n    \"ekrnepfw\",\n    \"epfwwfp\",\n    \"ekbdflt\",\n\
          \    \"epfw\",\n    \"fsgk32st\",\n    \"fswebuid\",\n    \"fsgk32\",\n\
          \    \"fsma32\",\n    \"fssm32\",\n    \"fnrb32\",\n    \"fsaua\",\n   \
          \ \"fsorsp\",\n    \"fsav32\",\n    \"f-secure gatekeeper handler starter\"\
          ,\n    \"f-secure network request broker\",\n    \"f-secure webui daemon\"\
          ,\n    \"fsma\",\n    \"fsorspclient\",\n    \"f-secure gatekeeper\",\n\
          \    \"f-secure hips\",\n    \"fsbts\",\n    \"fsni\",\n    \"fsvista\"\
          ,\n    \"f-secure filter\",\n    \"f-secure recognizer\",\n    \"fses\"\
          ,\n    \"fsfw\",\n    \"fsdfw\",\n    \"fsms\",\n    \"fsdevcon\"\n);\n\n\
          $currentServices = Get-Service | Select-Object -Property Name;\nforeach\
          \ ($svc in $currentServices) {\n    foreach ($secSvc in $securityServices)\
          \ {\n        if ($svc.Name -like $secSvc) {\n            $svcDetails = Get-Service\
          \ -name $svc.Name | Select-Object -Property Name, DisplayName, Status;\n\
          \            Write-Host \"[!] Security service found:\";\n            Write-Host\
          \ \"    Service Name:`t\", $svcDetails.Name;\n            Write-Host \"\
          \    Display Name:`t\", $svcDetails.DisplayName;\n            Write-Host\
          \ \"    Status:`t`t\", $svcDetails.Status;\n            Write-Host \"\"\
          ;\n        }\n    }\n}\n"
