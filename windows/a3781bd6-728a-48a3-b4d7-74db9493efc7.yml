- description: This test injects shellcode into a remote RegEdit process using the
    ListPlanting technique. ListPlanting exploits Window with ListView control. Code
    write to memory with NtWriteVirtualMemory. The shellcode is executed via PostMessage.
    When successful, a message box will appear with the title "Warning" and the content
    "Atomic Red Team" after a few seconds. Notepad will open following the appearance
    of the message box.
  id: a3781bd6-728a-48a3-b4d7-74db9493efc7
  name: Process injection ListPlanting
  platforms:
    windows:
      psh:
        cleanup: Get-Process -Name Notepad -ErrorAction SilentlyContinue | Stop-Process
          -Force
        command: Start-Process "1e835e_ListPlanting.exe"; Start-Sleep -Seconds 7;
          Get-Process -Name Notepad -ErrorAction SilentlyContinue | Stop-Process -Force
        parsers:
          plugins.atomic.app.parsers.atomic_powershell:
          - source: validate_me
        payloads:
        - 1e835e_ListPlanting.exe
  tactic: multiple
  technique:
    attack_id: T1055.015
    name: 'Process Injection: ListPlanting'
