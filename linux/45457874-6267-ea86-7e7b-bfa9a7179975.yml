- description: 'An adversary may try to re-purpose a system account to appear legitimate.
    In this test change the login shell of the nobody account, change its password
    to nobody, su to nobody, exit, then reset nobody''s shell to /usr/sbin/nologin.
    Here is how the nobody entry should look like in `/etc/passwd` before the test
    is executed and right after the cleanup: `# -> nobody:x:65534:65534:Unprivileged
    user:/nonexistent:/usr/sbin/nologin`

    '
  id: 45457874-6267-ea86-7e7b-bfa9a7179975
  name: Login as nobody (freebsd)
  platforms:
    linux:
      sh:
        cleanup: pw usermod nobody -s /usr/sbin/nologin; cat /etc/passwd |grep nobody
        command: cat /etc/passwd |grep nobody; pw usermod nobody -s /bin/sh; echo
          $(openssl passwd -1 art) | pw mod user nobody -h 0; su nobody; whoami; exit
        payloads: []
  tactic: multiple
  technique:
    attack_id: T1078.003
    name: 'Valid Accounts: Local Accounts'
