- description: "Instead of completely \"disabling\" iptables, adversaries may choose\
    \ to delete a certain rule, which, for example, blocks data exfiltration via ftp.\n\
    By doing so, they may cause less noise to avoid detection. \n"
  id: 2637ff89-f9e7-2d9e-b894-cf5ab38ac208
  name: Modify/delete iptables firewall rules
  platforms:
    linux:
      sh:
        cleanup: iptables-restore < /tmp/iptables.rules
        command: 'if [ ! -x "$(command -v iptables)" ]; then : ; else iptables-save
          > /tmp/iptables.rules; if echo "$(iptables -L)" | grep -q "DROP .*dpt:ftp";
          then echo "Rule found"; else echo "Rule not found. Setting it..."; iptables
          -A OUTPUT -p tcp --dport 21 -j DROP; fi; fi;  ;  iptables -D OUTPUT -p tcp
          --dport 21 -j DROP'
        payloads: []
  tactic: defense-evasion
  technique:
    attack_id: T1562.004
    name: 'Impair Defenses: Disable or Modify System Firewall'
