- description: 'Enable traffic redirection.


    Note that this test may conflict with pre-existing system configuration.

    '
  id: c3a35a15-ca98-fb18-620f-619be9efcd25
  name: Connection Proxy
  platforms:
    darwin:
      sh:
        cleanup: unset http_proxy; [ "false" == "true" ] && (kill -9 $(ps aux | grep
          "squid -N" | grep -v "grep" | awk '{print $2}'))
        command: 'if ([ "#{run_squid}" = "false" ] || ([ -x "$(command -v squid --version)"
          ] && (ps aux | grep "squid -N" | grep -v "grep"))); then : ; else [ "#{run_squid}"
          = "true" ] && ([ -x "$(command -v squid --version)" ] || sudo DEBIAN_FRONTEND=noninteractive
          apt-get -y install squid curl || sudo yum install -y squid curl || sudo
          dnf install -y squid curl || brew install curl squid) && (squid -N -d 1
          &) && exit 0; echo "Value #{run_squid} for variable "run_squid" is not valid"
          && exit 1; fi;  ;  export; curl'
        payloads: []
    linux:
      sh:
        cleanup: unset http_proxy; [ "false" == "true" ] && (kill -9 $(ps aux | grep
          "squid -N" | grep -v "grep" | awk '{print $2}'))
        command: 'if ([ "#{run_squid}" = "false" ] || ([ -x "$(command -v squid --version)"
          ] && (ps aux | grep "squid -N" | grep -v "grep"))); then : ; else [ "#{run_squid}"
          = "true" ] && ([ -x "$(command -v squid --version)" ] || sudo DEBIAN_FRONTEND=noninteractive
          apt-get -y install squid curl || sudo yum install -y squid curl || sudo
          dnf install -y squid curl || brew install curl squid) && (squid -N -d 1
          &) && exit 0; echo "Value #{run_squid} for variable "run_squid" is not valid"
          && exit 1; fi;  ;  export; curl'
        payloads: []
  tactic: command-and-control
  technique:
    attack_id: T1090.001
    name: 'Proxy: Internal Proxy'
