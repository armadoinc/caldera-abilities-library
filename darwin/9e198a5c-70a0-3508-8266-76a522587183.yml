- description: "system_profiler provides system hardware and software configuration\
    \ and the Model Identifier should provide the value similar to (sysctl -n hw.model).\
    \ \nWe should be able to find whether virtualization is enabled by checking whether\
    \ the Model Identifier does not contain \"Mac\".\n"
  id: 9e198a5c-70a0-3508-8266-76a522587183
  name: Detect Virtualization Environment using system_profiler
  platforms:
    darwin:
      sh:
        cleanup: ''
        command: 'if [ "$(system_profiler SPHardwareDataType | grep "Model Identifier"
          | grep -v ''Mac'')" != "" ]; then echo ''Virtualization Environment detected'';
          fi; '
        payloads: []
  tactic: multiple
  technique:
    attack_id: T1497.001
    name: 'Virtualization/Sandbox Evasion: System Checks'
