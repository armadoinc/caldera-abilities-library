- description: 'This command will copy Apple Notes database files using AppleScript
    as seen in Atomic Stealer.

    '
  id: 9143818a-f746-7aa6-b6bb-f999202baa69
  name: Copy Apple Notes database files using AppleScript
  platforms:
    darwin:
      sh:
        cleanup: rm "/private/tmp/NoteStore.sqlite*"
        command: osascript -e 'tell application "Finder"' -e 'set destinationFolderPath
          to POSIX file "#{destination_path}"' -e 'set notesFolderPath to (path to
          home folder as text) & "Library:Group Containers:group.com.apple.notes:"'
          -e 'set notesFolder to folder notesFolderPath' -e 'set notesFiles to {file
          "NoteStore.sqlite", file "NoteStore.sqlite-shm", file "NoteStore.sqlite-wal"}
          of notesFolder' -e 'repeat with aFile in notesFiles' -e 'duplicate aFile
          to folder destinationFolderPath with replacing' -e 'end' -e 'end tell'
        payloads: []
  tactic: collection
  technique:
    attack_id: T1005
    name: Data from Local System
