- description: 'sysctl hw.model will return the model name of the hardware(Macmini8,1,
    MacBookAir10,1, etc.) in case of native Apple hardware

    but will return the hypervisor name (VMware7,0).

    Reference: https://evasions.checkpoint.com/src/MacOS/macos.html#hardware-model

    '
  id: fe273ff9-035b-5fde-c0b9-8049752237e2
  name: Detect Virtualization Environment using sysctl (hw.model)
  platforms:
    darwin:
      sh:
        cleanup: ''
        command: 'if [ "$(sysctl -n hw.model | grep -v ''Mac'')" != "" ]; then echo
          ''Virtualization Environment detected''; fi; '
        payloads: []
  tactic: multiple
  technique:
    attack_id: T1497.001
    name: 'Virtualization/Sandbox Evasion: System Checks'
